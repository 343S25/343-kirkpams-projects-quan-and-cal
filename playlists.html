<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SpotifyClone</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background-color: #2a2a3d;
      padding: 20px;
      border-radius: 8px;
      color: white;
      min-width: 300px;
    }

    .modal-content input,
    .modal-content textarea {
      width: 100%;
      background-color: #1e1e2f;
      color: white;
      border: 1px solid #444;
      border-radius: 4px;
      padding: 8px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="navbar">
    <div class="title">
      <a href="frontpage.html">
        <img src="not-spotify-high-resolution-logo.png" alt="Logo" class="logo">
      </a>
    </div>    
    <div class="nav-buttons">
      <a href="search.html">Search</a>
      <a href="playlists.html">Playlists</a>
      <a href="trending.html">Trending</a>
    </div>
  </div>

  <main style="padding: 20px;">
    <h2>Create a Playlist</h2>
    <input type="text" id="playlist-name" placeholder="Playlist name"><br><br>
    <textarea id="playlist-desc" placeholder="Playlist description"></textarea><br><br>
    <input type="text" id="playlist-songs" placeholder="Comma-separated song titles"><br><br>
    <button onclick="savePlaylist()">Create Playlist</button>

    <h2>Existing Playlists</h2>
    <div id="existing-playlists"></div>
  </main>

  <!-- âœ¨ Modal for Editing -->
  <div id="edit-modal" class="modal">
    <div class="modal-content">
      <h3>Edit Playlist</h3>
      <input type="text" id="edit-name" placeholder="Playlist name"><br>
      <textarea id="edit-desc" placeholder="Description"></textarea><br>
      <input type="text" id="edit-songs" placeholder="Comma-separated songs"><br>
      <button onclick="saveEdit()">Save</button>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>

  <script>
    function savePlaylist() {
      const name = document.getElementById("playlist-name").value.trim();
      const desc = document.getElementById("playlist-desc").value.trim();
      const songs = document.getElementById("playlist-songs").value.trim().split(',').map(s => s.trim()).filter(Boolean);

      if (!name) return;

      const playlists = JSON.parse(localStorage.getItem("playlists")) || [];

      playlists.push({ name, desc, songs });
      localStorage.setItem("playlists", JSON.stringify(playlists));

      document.getElementById("playlist-name").value = "";
      document.getElementById("playlist-desc").value = "";
      document.getElementById("playlist-songs").value = "";

      displayPlaylists();
    }

    function deletePlaylist(index) {
      const playlists = JSON.parse(localStorage.getItem("playlists")) || [];
      playlists.splice(index, 1);
      localStorage.setItem("playlists", JSON.stringify(playlists));
      displayPlaylists();
    }

    let editIndex = null;

    function editPlaylist(index) {
      const playlists = JSON.parse(localStorage.getItem("playlists")) || [];
      const playlist = playlists[index];

      editIndex = index;
      document.getElementById("edit-name").value = playlist.name;
      document.getElementById("edit-desc").value = playlist.desc;
      document.getElementById("edit-songs").value = playlist.songs.join(', ');

      document.getElementById("edit-modal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("edit-modal").style.display = "none";
      editIndex = null;
    }

    function saveEdit() {
      const name = document.getElementById("edit-name").value.trim();
      const desc = document.getElementById("edit-desc").value.trim();
      const songs = document.getElementById("edit-songs").value.trim().split(',').map(s => s.trim()).filter(Boolean);

      if (!name || editIndex === null) return;

      const playlists = JSON.parse(localStorage.getItem("playlists")) || [];
      playlists[editIndex] = { name, desc, songs };
      localStorage.setItem("playlists", JSON.stringify(playlists));

      closeModal();
      displayPlaylists();
    }

    function displayPlaylists() {
      const container = document.getElementById("existing-playlists");
      const playlists = JSON.parse(localStorage.getItem("playlists")) || [];

      container.innerHTML = "";

      if (playlists.length === 0) {
        container.innerHTML = "<p>No playlists yet. Create one above! ðŸŽ¶</p>";
      } else {
        playlists.forEach((p, i) => {
          const div = document.createElement("div");
          div.className = "playlist-box";
          div.innerHTML = `
            <strong>${p.name}</strong><br>
            <em>${p.desc || 'No description'}</em><br>
            <span>Songs: ${Array.isArray(p.songs) ? p.songs.join(', ') : 'None'}</span><br><br>
            <button onclick="editPlaylist(${i})">Edit</button>
            <button onclick="deletePlaylist(${i})">Delete</button>
          `;
          container.appendChild(div);
        });
      }
    }

    document.addEventListener("DOMContentLoaded", displayPlaylists);
  </script>
</body>
</html>
